@echo off
mode 110,45
title Crear VM
cls

echo Cambiando de directorio...
cd C:\Archivos de programa\Oracle\VirtualBox
echo.
:: CREACION DE LA VM ===============================================
echo Proporcione el nombre de VM:
set /p dato1=nombreVM= 
echo Proporcione el SO:
set /p dato2=SO= 
echo.
echo Creando la VM...
VBoxManage createvm --name "%dato1%" --ostype "%dato2%" --register
:: ASIGNACION DE MEMORIA ===============================================
echo Proporcione el tamanio de la memoria de la VM:
set /p dato3=tamanioVM= 
echo Proporcione VRAM:
set /p dato4=vramVM= 
echo.
echo Asignando Memoria...
VBoxManage modifyvm "%dato1%" --cpus 1 --memory "%dato3%" --vram "%dato4%"
:: CREACION DEL DISCO DURO ===============================================
echo Proporcione el tamanio del disco duro:
set /p dato5=tamanioDisco= 
VBoxManage createhd --filename /path/to/hard_drive_image/"%dato1%".vdi --size "%dato5%"

echo Agregando controlador de almacenamiento...
VBoxManage storagectl "%dato1%" --name "SATA Controller" --add sata --bootable on

echo Conectando el Disco duro al Controlador
VBoxManage storageattach "%dato1%" --storagectl "SATA Controller" --port 0 --device 0 --type hdd --medium /path/to/hard_drive_image/"%dato1%".vdi

echo Ultimas configuraciones...
VBoxManage storagectl "%dato1%" --name "IDE Controller" --add ide
VBoxManage storageattach "%dato1%" --storagectl "IDE Controller" --port 0  --device 0 --type dvddrive --medium C:\Users\Karina\Downloads\Zorin-OS-15.3-Lite-64-bit.iso
:: START VM ===============================================
echo Inicializando la VM...
VBoxManage startvm "%dato1%"
pause