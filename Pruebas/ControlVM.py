import paramiko
import json

# Leer el archivo JSON
with open('configVM.json') as f:
    data = json.load(f)

# Obtener la configuración de conexión desde el archivo JSON
nombre_maquina_virtual = data['name']
direccion_ip = data['direccion_ip']
puerto = data['puerto']
usuario = data['usuario']
contrasena = data['contrasena']

# Crear una instancia de cliente SSH
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())

# Conectarse por SSH a la máquina virtual
ssh_client.connect(direccion_ip, port=puerto, username=usuario, password=contrasena)

# Ejecutar comandos remotos en la máquina virtual
stdin, stdout, stderr = ssh_client.exec_command('comando_remoto')

# Obtener la salida del comando remoto
output = stdout.read().decode('utf-8')
print(output)
# Ruta del archivo local a enviar
#ruta_archivo_local = 'hash.txt'
ruta_archivo_local = input('Ingrese el nombre del archivo a analizar: ')

# Ruta del archivo remoto (destino) en la máquina virtual
ruta_archivo_remoto = '/home/kary/Escritorio/archivo_remoto.txt'
# Crear un canal SFTP para la transferencia de archivos
sftp = ssh_client.open_sftp()
# Enviar el archivo local al servidor remoto
sftp.put(ruta_archivo_local, ruta_archivo_remoto)

# Cerrar la conexión SFTP y SSH
sftp.close()
# Cerrar la conexión SSH
ssh_client.close()


